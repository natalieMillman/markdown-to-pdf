<div class="container">
  <div class="header">
    <div class="header-content">
      <div class="title-section">
        <h1>📄 Markdown to PDF</h1>
        <p>Convert your markdown documents to beautiful PDFs instantly</p>
      </div>
      <div class="header-controls">
        <div class="theme-toggle-container">
          <span class="theme-label">{{ isDarkMode ? 'Dark Mode' : 'Light Mode' }}</span>
          <button 
            class="btn btn-theme-toggle" 
            (click)="toggleTheme()"
            [title]="isDarkMode ? 'Switch to light mode' : 'Switch to dark mode'">
            {{ isDarkMode ? '☀️' : '🌙' }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- File Upload Section -->
  <div class="card">
    <div class="form-group">
      <label class="form-label">Upload Markdown File:</label>
      <div 
        class="file-upload-area" 
        [class.drag-over]="isDragOver"
        [class.uploading]="isUploading"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event)"
        (click)="fileInput.click()">
        
        <div class="upload-content">
          <div class="upload-icon">📁</div>
          <div class="upload-text">
            <p><strong>Click to browse</strong> or drag and drop your markdown file here</p>
            <p class="upload-subtitle">Supports .md, .markdown, and .txt files</p>
          </div>
        </div>
        
        <input 
          #fileInput
          type="file" 
          accept=".md,.markdown,.txt,text/markdown,text/plain"
          (change)="onFileSelect($event)"
          style="display: none;">
      </div>
      
      <div *ngIf="uploadedFileName" class="uploaded-file-info">
        <div class="file-info">
          <span class="file-icon">📄</span>
          <span class="file-name">{{ uploadedFileName }}</span>
          <button class="btn-clear-file" (click)="clearUploadedFile()" title="Remove file">
            ❌
          </button>
        </div>
      </div>
      
      <div *ngIf="isUploading" class="upload-progress">
        <div class="loading-spinner"></div>
        <span>Reading file...</span>
      </div>
    </div>
  </div>

  <!-- PDF Generation Section -->
  <div class="card">
    <div class="pdf-config-header">
      <h3>PDF Configuration</h3>
      <button 
        class="btn btn-toggle" 
        (click)="toggleAdvancedOptions()"
        type="button">
        {{ showAdvancedOptions ? '🔼 Hide Advanced' : '🔽 Show Advanced' }}
      </button>
    </div>

    <!-- Basic Configuration -->
    <div class="pdf-config-grid">
      <div class="form-group">
        <label class="form-label" for="filename">PDF Filename:</label>
        <input 
          id="filename" 
          type="text" 
          class="form-control" 
          [(ngModel)]="filename" 
          placeholder="Enter filename (e.g., my-document.pdf)">
      </div>

      <div class="form-group">
        <label class="form-label" for="format">Page Format:</label>
        <select 
          id="format" 
          class="form-control" 
          [(ngModel)]="selectedFormat" 
          (change)="onFormatChange()">
          <option *ngFor="let key of getFormatKeys()" [ngValue]="pdfFormats[key]">
            {{ pdfFormats[key].name }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label" for="orientation">Orientation:</label>
        <select id="orientation" class="form-control" [(ngModel)]="orientation">
          <option value="portrait">📄 Portrait</option>
          <option value="landscape">📄 Landscape</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">Page Size:</label>
        <div class="page-size-display">{{ getPageDimensions() }}</div>
      </div>
    </div>

    <!-- Advanced Configuration -->
    <div *ngIf="showAdvancedOptions" class="advanced-config">
      <hr class="config-divider">
      
      <!-- Custom Size Controls -->
      <div *ngIf="selectedFormat.name === 'Custom'" class="custom-size-controls">
        <h4>Custom Page Size</h4>
        <div class="size-inputs">
          <div class="form-group">
            <label class="form-label" for="customWidth">Width (mm):</label>
            <input 
              id="customWidth" 
              type="number" 
              class="form-control" 
              [(ngModel)]="customWidth" 
              min="50" 
              max="500">
          </div>
          <div class="form-group">
            <label class="form-label" for="customHeight">Height (mm):</label>
            <input 
              id="customHeight" 
              type="number" 
              class="form-control" 
              [(ngModel)]="customHeight" 
              min="50" 
              max="500">
          </div>
        </div>
      </div>

      <!-- Margins Controls -->
      <div class="margins-controls">
        <div class="margins-header">
          <h4>Page Margins (mm)</h4>
          <button 
            class="btn btn-reset" 
            (click)="resetMargins()" 
            type="button">
            🔄 Reset
          </button>
        </div>
        <div class="margins-grid">
          <div class="form-group">
            <label class="form-label" for="marginTop">Top:</label>
            <input 
              id="marginTop" 
              type="number" 
              class="form-control" 
              [(ngModel)]="margins.top" 
              min="0" 
              max="50">
          </div>
          <div class="form-group">
            <label class="form-label" for="marginRight">Right:</label>
            <input 
              id="marginRight" 
              type="number" 
              class="form-control" 
              [(ngModel)]="margins.right" 
              min="0" 
              max="50">
          </div>
          <div class="form-group">
            <label class="form-label" for="marginBottom">Bottom:</label>
            <input 
              id="marginBottom" 
              type="number" 
              class="form-control" 
              [(ngModel)]="margins.bottom" 
              min="0" 
              max="50">
          </div>
          <div class="form-group">
            <label class="form-label" for="marginLeft">Left:</label>
            <input 
              id="marginLeft" 
              type="number" 
              class="form-control" 
              [(ngModel)]="margins.left" 
              min="0" 
              max="50">
          </div>
        </div>
      </div>
    </div>

    <div class="button-group">
      <button 
        class="btn btn-primary" 
        (click)="generatePDF()" 
        [disabled]="isGenerating">
        {{ isGenerating ? '🔄 Generating...' : '📥 Generate PDF' }}
      </button>
      <button 
        class="btn btn-secondary" 
        (click)="exportDocument()"
        [disabled]="isExporting || !markdownContent.trim()">
        {{ getExportButtonText() }}
      </button>
      <button 
        class="btn btn-secondary" 
        (click)="openPrintPreview()"
        [disabled]="!markdownContent.trim()">
        🖨️ Print Preview
      </button>
      <button class="btn btn-secondary" (click)="loadSample()">
        📋 Load Sample
      </button>
      <button class="btn btn-secondary" (click)="clearContent()">
        🗑️ Clear
      </button>
    </div>

    <!-- Export Format Selection -->
    <div class="export-format-section">
      <div class="form-group">
        <label class="form-label">Export Format:</label>
        <div class="export-format-grid">
          <div *ngFor="let format of exportFormats" 
               class="export-format-option"
               [class.selected]="selectedExportFormat === format.value"
               (click)="selectedExportFormat = format.value">
            <span class="format-icon">{{ format.icon }}</span>
            <span class="format-label">{{ format.label }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Display Settings -->
  <div class="card">
    <div class="display-settings-header">
      <h3>Display Settings</h3>
      <button 
        class="btn btn-reset" 
        (click)="resetDisplaySettings()" 
        type="button">
        🔄 Reset
      </button>
    </div>

    <div class="display-settings-grid">
      <div class="form-group">
        <label class="form-label" for="fontFamily">Font Family:</label>
        <select 
          id="fontFamily" 
          class="form-control" 
          [value]="displaySettings.fontFamily.value"
          (change)="onFontFamilyChange($any($event.target).value)">
          <optgroup label="Sans-serif">
            <option *ngFor="let font of getSansSerifFonts()" 
                    [value]="font.value">
              {{ font.name }}
            </option>
          </optgroup>
          <optgroup label="Serif">
            <option *ngFor="let font of getSerifFonts()" 
                    [value]="font.value">
              {{ font.name }}
            </option>
          </optgroup>
          <optgroup label="Monospace">
            <option *ngFor="let font of getMonospaceFonts()" 
                    [value]="font.value">
              {{ font.name }}
            </option>
          </optgroup>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label" for="fontSize">Font Size: {{ displaySettings.fontSize }}px</label>
        <div class="font-size-controls">
          <input 
            id="fontSize"
            type="range" 
            class="font-size-slider" 
            min="10" 
            max="24" 
            step="1"
            [value]="displaySettings.fontSize"
            (input)="onFontSizeChange(+$any($event.target).value)">
          <div class="font-size-buttons">
            <button 
              class="btn btn-font-size" 
              (click)="onFontSizeChange(displaySettings.fontSize - 1)"
              [disabled]="displaySettings.fontSize <= 10">
              −
            </button>
            <span class="font-size-display">{{ displaySettings.fontSize }}px</span>
            <button 
              class="btn btn-font-size" 
              (click)="onFontSizeChange(displaySettings.fontSize + 1)"
              [disabled]="displaySettings.fontSize >= 24">
              +
            </button>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Preview:</label>
        <div class="font-preview" [style.font-family]="displaySettings.fontFamily.value" [style.font-size.px]="displaySettings.fontSize">
          The quick brown fox jumps over the lazy dog. 1234567890
        </div>
      </div>
    </div>
  </div>

  <div class="grid">
    <div class="card">
      <div class="form-group">
        <label class="form-label" for="markdown">Markdown Content:</label>
        <textarea 
          id="markdown"
          class="form-control" 
          [(ngModel)]="markdownContent" 
          (input)="updatePreview()"
          placeholder="Type your markdown here...
          
Example:
# My Document
This is **bold** and *italic* text.

- List item 1
- List item 2

```javascript
console.log('Hello World!');
```"></textarea>
      </div>
    </div>

    <div class="card">
      <div class="form-group">
        <label class="form-label">Live Preview:</label>
        <div class="preview-container" [innerHTML]="htmlPreview"></div>
      </div>
    </div>
  </div>
</div>
